# Shopify Metaobject and Metafield Definitions
# For use with Shopify CLI
#
# To apply these definitions:
# 1. Ensure you're logged in: shopify auth login
# 2. Run: shopify metafield definitions push --file shopify-metaobjects.toml
#    Or for app-owned metafields, add to your shopify.app.toml
#
# Note: Shopify CLI support for metaobjects is evolving. If push fails,
# use the GraphQL Admin API approach instead (see shopify-metaobjects-graphql.md)

# ============================================================
# METAOBJECT DEFINITION: Review
# ============================================================

[metaobjects.custom.review]
name = "Review"
description = "Customer product reviews with rating, text, and metadata"
access.admin = "MERCHANT_READ_WRITE"
access.storefront = "PUBLIC_READ"

[[metaobjects.custom.review.field_definitions]]
key = "reviewer_name"
name = "Reviewer Name"
type = "single_line_text_field"
required = true

[[metaobjects.custom.review.field_definitions]]
key = "star_rating"
name = "Rating"
type = "number_integer"
required = true
validations = [{ name = "min", value = "1" }, { name = "max", value = "5" }]

[[metaobjects.custom.review.field_definitions]]
key = "title"
name = "Review Title"
type = "single_line_text_field"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "review_text"
name = "Review Text"
type = "multi_line_text_field"
required = true

[[metaobjects.custom.review.field_definitions]]
key = "location"
name = "Location"
type = "single_line_text_field"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "product"
name = "Product"
type = "product_reference"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "verified_purchase"
name = "Verified Purchase"
type = "boolean"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "featured"
name = "Featured Review"
type = "boolean"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "review_date"
name = "Review Date"
type = "date"
required = false

[[metaobjects.custom.review.field_definitions]]
key = "avatar_image"
name = "Avatar Image"
type = "file_reference"
required = false
validations = [{ name = "file_type_options", value = '["image"]' }]

# ============================================================
# PRODUCT METAFIELD DEFINITION: Product Reviews
# ============================================================
# This creates a list of Review metaobject references on products

[product.metafields.custom.product_reviews]
name = "Product Reviews"
description = "Collection of customer reviews for this product"
type = "list.metaobject_reference"
access.admin = "MERCHANT_READ_WRITE"
access.storefront = "PUBLIC_READ"
# Reference to the Review metaobject
metaobject_reference = "custom.review"
